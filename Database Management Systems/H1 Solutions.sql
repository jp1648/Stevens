Name: Jay PatelID: 20019207 	Problem 1:      with p1 as ( select cust, min(quant) min_q, max(quant) max_q, round(avg(quant),0) avg_q from sales group by cust), p2 as(select p1.cust customer, 	 p1.min_q, 	 s.prod min_prod,	 s.date min_date, 	 s.state st, 	 p1.max_q, 	 p1.avg_q from p1, sales s where p1.cust = s.cust and p1.min_q = s.quant), p3 as (select p2.customer,	 p2.min_q, 	 p2.min_prod,	 p2.min_date, 	 p2.st, 	 p2.max_q,	 s.prod max_prod,	 s.date max_date,	 s.state st, 	 p2.avg_q from p2, sales s where p2.customer = s.cust and p2.max_q = s.quant)select * from p3Problem 2:with p1 as (select year, month, day, sum(quant) as qfrom salesgroup by year, month, dayorder by year, month, day), p2 as (select p1.month,p1.year, max(p1.q) as max_q, min(p1.q) as min_qfrom p1group by p1.month,p1.yearorder by p1.year, p1.month), p3 as(select p2.year, p2.month, p1.day as slowest_day, p2.min_q as slowest_total_qfrom p1, p2where p1.q = p2.min_qorder by year, month), p4 as (select p2.year, p2.month, p1.day as busiest_day, p2.max_q as busiest_total_qfrom p1, p2where p1.q = p2.max_qorder by year, month) select  p4.year,  p4.month,  p4.busiest_day AS busiest_day,  p4.busiest_total_q AS busiest_total_q,  p3.slowest_day AS slowest_day,  p3.slowest_total_q AS slowest_total_qfrom p4, p3where p4.year = p3.year AND p4.month = p3.month;Problem 3:with base as (	select cust, prod, sum(quant) as total from sales	group by cust, prod	order by cust, prod), low as (	select cust, min(total) as less	from base	group by cust), high as (	select cust, max(total) as most	from base	group by cust) select b1.cust, b2.prod as most_fav_prod, b1.prod as least_fav_prod	from base b1, base b2, low, high	where b1.total = low.less	and b2.total = high.most	and b1.cust = b2.custProblem 4:select      cust,	prod,	(select sum(quant) from sales where cust = s.cust and prod = s.prod and month in (3, 4, 5)) as spring_avg,	(select sum(quant) from sales where cust = s.cust and prod = s.prod and month in (6, 7, 8)) as summer_avg,	(select sum(quant) from sales where cust = s.cust and prod = s.prod and month in (9, 10, 11)) as fall_avg,	(select sum(quant) from sales where cust = s.cust and prod = s.prod and month in (12, 1, 2)) as winter_avg,	round(avg(quant),0) as average,	sum(quant) as total,	count(quant) as countfrom	sales sgroup by	cust,	prodorder by	cust,	prodProblem 5:with quant_quarter as (  select    prod,    extract(quarter from date) as quarter,    max(quant) as max_quant  from sales  group by prod, extract(quarter from date))select  s.prod,  max(case when q.quarter = 1 then s.quant end) as q1_max_sales,  max(case when q.quarter = 1 then s.date end) as q1_date,  max(case when q.quarter = 2 then s.quant end) as q2_max_sales,  max(case when q.quarter = 2 then s.date end) as q2_date,  max(case when q.quarter = 3 then s.quant end) as q3_max_sales,  max(case when q.quarter = 3 then s.date end) as q3_date,  max(case when q.quarter = 4 then s.quant end) as q4_max_sales,  max(case when q.quarter = 4 then s.date end) as q4_datefrom sales sjoin quant_quarter q on s.prod = q.prod and extract(quarter from s.date) = q.quarter and s.quant = q.max_quantgroup by s.prodorder by s.prod;      